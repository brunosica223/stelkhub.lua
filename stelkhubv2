--[[
    STELK HUB - LEAF WORLD
    VersÃ£o: 12.0 - AUTO FARM
    - Farm automÃ¡tico infinito com respawn
    - Units atacam o mob
    - Cancelar TP em bosses
    - Estrelas com nome exato "Star"
    - DetecÃ§Ã£o de units melhorada
]]

local player = game.Players.LocalPlayer
local guiService = game:GetService("CoreGui")
local runService = game:GetService("RunService")
local tweenService = game:GetService("TweenService")
local userInputService = game:GetService("UserInputService")

-- ================ VARIÃVEIS ================

local bypassActive = false
local farmActive = false
local selectedMob = nil
local selectedUnit = nil
local currentWorld = "Desconhecido"
local inLeafWorld = false
local gems = 0
local gold = 0
local selectedStar = nil
local stars = {}
local mobs = {}
local units = {}
local hubVisible = true
local farmConnection = nil
local currentTarget = nil
local isBoss = false

-- ================ CORES ================

local colors = {
    background = Color3.fromRGB(18, 18, 18),
    secondary = Color3.fromRGB(30, 30, 30),
    tertiary = Color3.fromRGB(45, 45, 45),
    accent = Color3.fromRGB(255, 255, 255),
    success = Color3.fromRGB(100, 200, 100),
    danger = Color3.fromRGB(255, 80, 80),
    text = Color3.fromRGB(255, 255, 255),
    textDim = Color3.fromRGB(180, 180, 180),
    highlight = Color3.fromRGB(70, 70, 70),
    selected = Color3.fromRGB(80, 150, 255),
    warning = Color3.fromRGB(255, 200, 100)
}

-- ================ DETECÃ‡ÃƒO DE MUNDO ================

local function detectLeafWorld()
    local leafKeywords = {
        "leaf", "village", "konoha", "naruto", "hokage",
        "folha", "kakashi", "sasuke", "sakura", "chakra"
    }
    
    for _, obj in ipairs(workspace:GetDescendants()) do
        local name = obj.Name:lower()
        for _, kw in ipairs(leafKeywords) do
            if name:find(kw) then
                inLeafWorld = true
                return "ðŸƒ LEAF WORLD", colors.success
            end
        end
    end
    
    inLeafWorld = false
    return "âŒ FORA DO LEAF WORLD", colors.danger
end

-- ================ DETECÃ‡ÃƒO DE GEMS E GOLD ================

local function getGemsAndGold()
    gems = 0
    gold = 0

    if player:FindFirstChild("leaderstats") then
        for _, child in ipairs(player.leaderstats:GetChildren()) do
            local name = child.Name:lower()
            if name:find("gem") then gems = child.Value or 0 end
            if name:find("gold") or name:find("coin") then gold = child.Value or 0 end
        end
    end

    return gems, gold
end

-- ================ SISTEMA DE STARS (NOME EXATO) ================

local function findStars()
    local found = {}
    
    if not inLeafWorld then 
        print("ðŸ” Fora do Leaf World - nÃ£o procurando estrelas")
        return found 
    end
    
    print("ðŸ” Procurando Stars no Leaf World...")
    
    -- Nome exato "Star" (como o dev disse)
    for _, obj in ipairs(workspace:GetDescendants()) do
        if obj.Name == "Star" then
            print("âœ… Encontrado: " .. obj.Name)
            table.insert(found, obj)
        elseif obj.Name:sub(1,4) == "Star" then
            print("âœ… Encontrado: " .. obj.Name)
            table.insert(found, obj)
        end
        
        -- Procura por ClickDetectors com parent "Star"
        if obj:IsA("ClickDetector") and obj.Parent then
            if obj.Parent.Name == "Star" or obj.Parent.Name:sub(1,4) == "Star" then
                print("âœ… Encontrado ClickDetector em: " .. obj.Parent.Name)
                table.insert(found, obj.Parent)
            end
        end
        
        if #found >= 6 then break end
    end
    
    print("ðŸ” Total de Stars: " .. #found)
    return found
end

local function spinStar(star)
    if not star then return false end

    local detector = star:FindFirstChildOfClass("ClickDetector")
    if detector then
        fireclickdetector(detector)
        return true
    end

    local prompt = star:FindFirstChildOfClass("ProximityPrompt")
    if prompt then
        prompt:InputHoldBegin()
        task.wait(0.1)
        prompt:InputHoldEnd()
        return true
    end

    return false
end

-- ================ SISTEMA DE MOBS ================

local function findMobs()
    local found = {}
    
    for _, obj in ipairs(workspace:GetDescendants()) do
        if obj:IsA("Model") and obj:FindFirstChildOfClass("Humanoid") then
            local name = obj.Name:lower()
            local health = obj:FindFirstChildOfClass("Humanoid").Health
            local maxHealth = obj:FindFirstChildOfClass("Humanoid").MaxHealth
            
            -- Verificar se Ã© boss (muito HP)
            local isBossMob = false
            if maxHealth > 100000 then
                isBossMob = true
            end
            if name:find("boss") then
                isBossMob = true
            end
            
            if name:find("mob") or name:find("boss") or name:find("enemy") or name:find("leaf") then
                table.insert(found, {
                    Object = obj,
                    Name = obj.Name,
                    Health = health,
                    MaxHealth = maxHealth,
                    IsBoss = isBossMob
                })
            end
        end
    end
    
    return found
end

-- ================ SISTEMA DE UNITS (BUSCA PROFUNDA) ================

local function findUnits()
    local found = {}
    
    -- FunÃ§Ã£o recursiva para procurar em todas as pastas
    local function searchIn(container)
        if not container then return end
        for _, child in ipairs(container:GetChildren()) do
            if child:IsA("Model") or child:IsA("Folder") then
                -- Tenta encontrar valor de dano
                local damage = 0
                local damageValue = child:FindFirstChild("Damage") or 
                                    child:FindFirstChild("Power") or 
                                    child:FindFirstChild("Atk") or
                                    child:FindFirstChild("Attack") or
                                    child:FindFirstChild("Dano")
                if damageValue and damageValue:IsA("NumberValue") then
                    damage = damageValue.Value
                end
                
                -- Verifica se tem Humanoid (Ã© uma unit viva)
                local hasHumanoid = child:FindFirstChildOfClass("Humanoid") ~= nil
                
                -- Se tem dano ou nome sugestivo, adiciona
                if damage > 0 or child.Name:lower():find("unit") or child.Name:lower():find("pet") or hasHumanoid then
                    table.insert(found, {
                        Name = child.Name,
                        Damage = damage,
                        Object = child,
                        HasHumanoid = hasHumanoid
                    })
                end
                
                -- Continua procurando dentro
                searchIn(child)
            end
        end
    end
    
    -- Pastas principais
    local roots = {
        player,
        player:FindFirstChild("PlayerGui"),
        player:FindFirstChild("Backpack"),
        player:FindFirstChild("StarterGear"),
        game:GetService("ReplicatedStorage")
    }
    
    for _, root in ipairs(roots) do
        if root then
            searchIn(root)
        end
    end
    
    -- Ordenar por dano
    table.sort(found, function(a, b) return a.Damage > b.Damage end)
    
    return found
end

-- ================ COMANDOS PARA UNITS ATACAREM ================

local function commandUnitsToAttack(target)
    if not target then return end
    
    -- Tenta diferentes mÃ©todos para fazer as units atacarem
    for _, unit in ipairs(units) do
        if unit.Object and unit.Object.Parent then
            -- MÃ©todo 1: RemoteEvent de ataque
            local attackRemote = unit.Object:FindFirstChild("Attack") or 
                                 unit.Object:FindFirstChild("Skill") or
                                 unit.Object:FindFirstChild("Combat")
            
            if attackRemote and attackRemote:IsA("RemoteEvent") then
                attackRemote:FireServer(target)
            end
            
            -- MÃ©todo 2: Colocar target no Humanoid
            if unit.HasHumanoid then
                local humanoid = unit.Object:FindFirstChildOfClass("Humanoid")
                if humanoid then
                    -- Tenta definir target (alguns jogos usam isso)
                    local targetValue = unit.Object:FindFirstChild("Target")
                    if targetValue and targetValue:IsA("ObjectValue") then
                        targetValue.Value = target
                    end
                end
            end
        end
    end
end

-- ================ FARM AUTOMÃTICO ================

local function startFarming()
    if not selectedMob then
        print("âŒ Selecione um mob primeiro")
        return
    end
    
    farmActive = true
    print("âš”ï¸ Farm automÃ¡tico iniciado para: " .. selectedMob.Name)
    
    farmConnection = task.spawn(function()
        while farmActive do
            -- Procurar o mob atual (pode ter respawnado)
            local currentMob = nil
            for _, mob in ipairs(mobs) do
                if mob.Object and mob.Object.Parent and mob.Name == selectedMob.Name then
                    currentMob = mob
                    break
                end
            end
            
            if not currentMob then
                -- Mob morreu, esperar respawn
                print("â³ Mob morto, aguardando respawn...")
                task.wait(5) -- Ajuste conforme necessÃ¡rio
            else
                -- Verificar se Ã© boss
                if currentMob.IsBoss then
                    print("âš ï¸ Boss detectado - cancelando TP para evitar kick")
                    -- NÃ£o faz TP, apenas ataca de longe
                    commandUnitsToAttack(currentMob.Object)
                    task.wait(2)
                else
                    -- Fazer TP suave
                    local root = currentMob.Object:FindFirstChild("HumanoidRootPart") or 
                                currentMob.Object:FindFirstChild("Torso") or 
                                currentMob.Object:FindFirstChild("UpperTorso")
                    
                    if root and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                        local charRoot = player.Character.HumanoidRootPart
                        local targetPos = root.Position + Vector3.new(0, 5, 0)
                        local distance = (targetPos - charRoot.Position).Magnitude
                        
                        -- TP suave
                        if distance > 50 then
                            local tweenInfo = TweenInfo.new(distance / 100, Enum.EasingStyle.Linear)
                            local goal = {CFrame = CFrame.new(targetPos)}
                            local tween = tweenService:Create(charRoot, tweenInfo, goal)
                            tween:Play()
                            tween.Completed:Wait()
                        end
                        
                        -- Comandar units para atacar
                        commandUnitsToAttack(currentMob.Object)
                        
                        -- Verificar se o mob morreu
                        local humanoid = currentMob.Object:FindFirstChildOfClass("Humanoid")
                        if humanoid and humanoid.Health <= 0 then
                            print("ðŸ’° Mob morto, gold farmado!")
                            -- Atualizar lista de mobs
                            mobs = findMobs()
                        end
                    end
                end
            end
            task.wait(1)
        end
    end)
end

local function stopFarming()
    farmActive = false
    if farmConnection then
        farmConnection = nil
    end
    print("â¹ï¸ Farm automÃ¡tico parado")
end

-- ================ EQUIPAR MELHOR UNIT ================

local function equipBestUnit()
    units = findUnits()
    
    if #units == 0 then
        print("âŒ Nenhuma unit encontrada")
        return
    end
    
    local best = units[1]
    print("âœ… Melhor unit: " .. best.Name .. " (Dano: " .. best.Damage .. ")")
    
    if best.Object then
        -- Tenta remote
        local remote = player:FindFirstChild("EquipUnit") or 
                      player:FindFirstChild("SelectUnit") or
                      game:GetService("ReplicatedStorage"):FindFirstChild("EquipUnit")
        
        if remote and remote:IsA("RemoteEvent") then
            remote:FireServer(best.Object)
        end
    end
end

-- ================ BYPASS ================

local function toggleBypass()
    if bypassActive then
        bypassActive = false
        return
    end

    bypassActive = true

    pcall(function()
        local mt = getrawmetatable and getrawmetatable(game) or getmetatable(game)
        if mt then
            local oldNamecall = mt.__namecall
            setreadonly(mt, false)

            mt.__namecall = newcclosure(function(self, ...)
                local method = getnamecallmethod()
                if method == "FireServer" then
                    local remoteName = tostring(self):lower()
                    if remoteName:find("anticheat") then
                        return
                    end
                end
                return oldNamecall(self, ...)
            end)
            setreadonly(mt, true)
        end
    end)
end

-- ================ CRIAR GUI ================

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "StelkHub"
screenGui.Parent = player:WaitForChild("PlayerGui")
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- BotÃ£o toggle
local toggleBtn = Instance.new("TextButton")
toggleBtn.Parent = screenGui
toggleBtn.BackgroundColor3 = colors.accent
toggleBtn.Size = UDim2.new(0, 40, 0, 40)
toggleBtn.Position = UDim2.new(0, 10, 0, 10)
toggleBtn.Text = "â‰¡"
toggleBtn.TextColor3 = colors.background
toggleBtn.Font = Enum.Font.GothamBold
toggleBtn.TextSize = 24
toggleBtn.BorderSizePixel = 0

local toggleCorner = Instance.new("UICorner")
toggleCorner.CornerRadius = UDim.new(0, 8)
toggleCorner.Parent = toggleBtn

-- Frame principal
local mainFrame = Instance.new("Frame")
mainFrame.Parent = screenGui
mainFrame.BackgroundColor3 = colors.background
mainFrame.BorderSizePixel = 0
mainFrame.Size = UDim2.new(0, 400, 0, 400)
mainFrame.Position = UDim2.new(0.5, -200, 0.5, -200)
mainFrame.Active = true
mainFrame.Draggable = true
mainFrame.Visible = true

-- Top Bar
local topBar = Instance.new("Frame")
topBar.Parent = mainFrame
topBar.BackgroundColor3 = colors.secondary
topBar.Size = UDim2.new(1, 0, 0, 40)
topBar.BorderSizePixel = 0

local title = Instance.new("TextLabel")
title.Parent = topBar
title.BackgroundTransparency = 1
title.Size = UDim2.new(0, 200, 1, 0)
title.Position = UDim2.new(0, 10, 0, 0)
title.Text = "STELK HUB"
title.TextColor3 = colors.accent
title.Font = Enum.Font.GothamBold
title.TextSize = 18
title.TextXAlignment = Enum.TextXAlignment.Left

-- Abas
local tabContainer = Instance.new("Frame")
tabContainer.Parent = mainFrame
tabContainer.BackgroundColor3 = colors.secondary
tabContainer.Size = UDim2.new(1, 0, 0, 35)
tabContainer.Position = UDim2.new(0, 0, 0, 40)
tabContainer.ClipsDescendants = true

local tabScrolling = Instance.new("ScrollingFrame")
tabScrolling.Parent = tabContainer
tabScrolling.BackgroundTransparency = 1
tabScrolling.Size = UDim2.new(1, 0, 1, 0)
tabScrolling.CanvasSize = UDim2.new(2.5, 0, 0, 0)
tabScrolling.ScrollBarThickness = 0
tabScrolling.BorderSizePixel = 0

local function createTab(name, pos)
    local btn = Instance.new("TextButton")
    btn.Parent = tabScrolling
    btn.BackgroundColor3 = colors.background
    btn.Size = UDim2.new(0, 70, 0, 25)
    btn.Position = UDim2.new(0, pos, 0.5, -12.5)
    btn.Text = name
    btn.TextColor3 = colors.textDim
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 12
    btn.AutoButtonColor = false
    btn.BorderSizePixel = 0
    return btn
end

local tab1 = createTab("MUNDO", 10)
local tab2 = createTab("STARS", 90)
local tab3 = createTab("MOBS", 170)
local tab4 = createTab("UNITS", 250)
local tab5 = createTab("FARM", 330) -- Nova aba de Farm

local pageIndicator = Instance.new("Frame")
pageIndicator.Parent = tabScrolling
pageIndicator.BackgroundColor3 = colors.accent
pageIndicator.Size = UDim2.new(0, 50, 0, 2)
pageIndicator.Position = UDim2.new(0, 20, 1, -5)
pageIndicator.BorderSizePixel = 0

-- ConteÃºdo
local content = Instance.new("ScrollingFrame")
content.Parent = mainFrame
content.BackgroundColor3 = colors.background
content.Size = UDim2.new(1, -20, 1, -95)
content.Position = UDim2.new(0, 10, 0, 85)
content.CanvasSize = UDim2.new(0, 0, 2, 0)
content.ScrollBarThickness = 4
content.BorderSizePixel = 0

local contentCorner = Instance.new("UICorner")
contentCorner.CornerRadius = UDim.new(0, 8)
contentCorner.Parent = content

-- PÃGINA 1: MUNDO (igual antes)
local page1 = Instance.new("Frame")
page1.Parent = content
page1.BackgroundTransparency = 1
page1.Size = UDim2.new(1, 0, 0, 250)
page1.Position = UDim2.new(0, 0, 0, 0)
page1.Visible = true

-- (manter o cÃ³digo da pÃ¡gina 1 igual ao anterior)
-- [CÃ³digo da pÃ¡gina 1 omitido por brevidade, mas deve ser mantido]

-- PÃGINA 2: STARS
local page2 = Instance.new("Frame")
page2.Parent = content
page2.BackgroundTransparency = 1
page2.Size = UDim2.new(1, 0, 0, 300)
page2.Position = UDim2.new(0, 0, 0, 0)
page2.Visible = false

local starsTitle = Instance.new("TextLabel")
starsTitle.Parent = page2
starsTitle.BackgroundTransparency = 1
starsTitle.Size = UDim2.new(1, -20, 0, 30)
starsTitle.Position = UDim2.new(0, 10, 0, 5)
starsTitle.Text = "â­ STARS"
starsTitle.TextColor3 = colors.accent
starsTitle.Font = Enum.Font.GothamBold
starsTitle.TextSize = 18
starsTitle.TextXAlignment = Enum.TextXAlignment.Left

local starsList = Instance.new("TextLabel")
starsList.Parent = page2
starsList.BackgroundColor3 = colors.secondary
starsList.Size = UDim2.new(0, 360, 0, 120)
starsList.Position = UDim2.new(0.5, -180, 0, 40)
starsList.Text = "Aguardando...\nEntre no Leaf World"
starsList.TextColor3 = colors.textDim
starsList.Font = Enum.Font.Gotham
starsList.TextSize = 12
starsList.TextWrapped = true
starsList.TextXAlignment = Enum.TextXAlignment.Left
starsList.TextYAlignment = Enum.TextYAlignment.Top

local starsCorner = Instance.new("UICorner")
starsCorner.CornerRadius = UDim.new(0, 8)
starsCorner.Parent = starsList

local refreshStarsBtn = Instance.new("TextButton")
refreshStarsBtn.Parent = page2
refreshStarsBtn.BackgroundColor3 = colors.tertiary
refreshStarsBtn.Size = UDim2.new(0, 100, 0, 30)
refreshStarsBtn.Position = UDim2.new(0.5, -160, 0, 170)
refreshStarsBtn.Text = "ðŸ”„ ATUALIZAR"
refreshStarsBtn.TextColor3 = colors.text
refreshStarsBtn.Font = Enum.Font.GothamBold
refreshStarsBtn.TextSize = 11

local refreshCorner = Instance.new("UICorner")
refreshCorner.CornerRadius = UDim.new(0, 6)
refreshCorner.Parent = refreshStarsBtn

local spinStarBtn = Instance.new("TextButton")
spinStarBtn.Parent = page2
spinStarBtn.BackgroundColor3 = colors.tertiary
spinStarBtn.Size = UDim2.new(0, 100, 0, 30)
spinStarBtn.Position = UDim2.new(0.5, -50, 0, 170)
spinStarBtn.Text = "ðŸŽ¯ GIRAR #1"
spinStarBtn.TextColor3 = colors.text
spinStarBtn.Font = Enum.Font.GothamBold
spinStarBtn.TextSize = 11

local spinCorner = Instance.new("UICorner")
spinCorner.CornerRadius = UDim.new(0, 6)
spinCorner.Parent = spinStarBtn

-- PÃGINA 3: MOBS
local page3 = Instance.new("Frame")
page3.Parent = content
page3.BackgroundTransparency = 1
page3.Size = UDim2.new(1, 0, 0, 400)
page3.Position = UDim2.new(0, 0, 0, 0)
page3.Visible = false

local mobsTitle = Instance.new("TextLabel")
mobsTitle.Parent = page3
mobsTitle.BackgroundTransparency = 1
mobsTitle.Size = UDim2.new(1, -20, 0, 30)
mobsTitle.Position = UDim2.new(0, 10, 0, 5)
mobsTitle.Text = "ðŸ‘¾ MOBS"
mobsTitle.TextColor3 = colors.accent
mobsTitle.Font = Enum.Font.GothamBold
mobsTitle.TextSize = 18
mobsTitle.TextXAlignment = Enum.TextXAlignment.Left

local mobsScrolling = Instance.new("ScrollingFrame")
mobsScrolling.Parent = page3
mobsScrolling.BackgroundColor3 = colors.secondary
mobsScrolling.Size = UDim2.new(0, 360, 0, 200)
mobsScrolling.Position = UDim2.new(0.5, -180, 0, 40)
mobsScrolling.CanvasSize = UDim2.new(0, 0, 2, 0)
mobsScrolling.ScrollBarThickness = 4
mobsScrolling.BorderSizePixel = 0

local mobsCorner = Instance.new("UICorner")
mobsCorner.CornerRadius = UDim.new(0, 8)
mobsCorner.Parent = mobsScrolling

local selectedMobFrame = Instance.new("Frame")
selectedMobFrame.Parent = page3
selectedMobFrame.BackgroundColor3 = colors.tertiary
selectedMobFrame.Size = UDim2.new(0, 360, 0, 35)
selectedMobFrame.Position = UDim2.new(0.5, -180, 0, 250)
selectedMobFrame.BorderSizePixel = 0

local selectedCorner = Instance.new("UICorner")
selectedCorner.CornerRadius = UDim.new(0, 6)
selectedCorner.Parent = selectedMobFrame

local selectedMobText = Instance.new("TextLabel")
selectedMobText.Parent = selectedMobFrame
selectedMobText.BackgroundTransparency = 1
selectedMobText.Size = UDim2.new(1, -10, 1, 0)
selectedMobText.Position = UDim2.new(0, 10, 0, 0)
selectedMobText.Text = "Nenhum mob selecionado"
selectedMobText.TextColor3 = colors.textDim
selectedMobText.Font = Enum.Font.Gotham
selectedMobText.TextSize = 12
selectedMobText.TextXAlignment = Enum.TextXAlignment.Left

local refreshMobsBtn = Instance.new("TextButton")
refreshMobsBtn.Parent = page3
refreshMobsBtn.BackgroundColor3 = colors.tertiary
refreshMobsBtn.Size = UDim2.new(0, 330, 0, 30)
refreshMobsBtn.Position = UDim2.new(0.5, -165, 0, 295)
refreshMobsBtn.Text = "ðŸ”„ ATUALIZAR MOBS"
refreshMobsBtn.TextColor3 = colors.text
refreshMobsBtn.Font = Enum.Font.GothamBold
refreshMobsBtn.TextSize = 11

local refreshMobsCorner = Instance.new("UICorner")
refreshMobsCorner.CornerRadius = UDim.new(0, 6)
refreshMobsCorner.Parent = refreshMobsBtn

-- PÃGINA 4: UNITS
local page4 = Instance.new("Frame")
page4.Parent = content
page4.BackgroundTransparency = 1
page4.Size = UDim2.new(1, 0, 0, 400)
page4.Position = UDim2.new(0, 0, 0, 0)
page4.Visible = false

local unitsTitle = Instance.new("TextLabel")
unitsTitle.Parent = page4
unitsTitle.BackgroundTransparency = 1
unitsTitle.Size = UDim2.new(1, -20, 0, 30)
unitsTitle.Position = UDim2.new(0, 10, 0, 5)
unitsTitle.Text = "âš”ï¸ UNITS"
unitsTitle.TextColor3 = colors.accent
unitsTitle.Font = Enum.Font.GothamBold
unitsTitle.TextSize = 18
unitsTitle.TextXAlignment = Enum.TextXAlignment.Left

local unitsScrolling = Instance.new("ScrollingFrame")
unitsScrolling.Parent = page4
unitsScrolling.BackgroundColor3 = colors.secondary
unitsScrolling.Size = UDim2.new(0, 360, 0, 250)
unitsScrolling.Position = UDim2.new(0.5, -180, 0, 40)
unitsScrolling.CanvasSize = UDim2.new(0, 0, 2, 0)
unitsScrolling.ScrollBarThickness = 4
unitsScrolling.BorderSizePixel = 0

local unitsCorner = Instance.new("UICorner")
unitsCorner.CornerRadius = UDim.new(0, 8)
unitsCorner.Parent = unitsScrolling

local equipBestBtn = Instance.new("TextButton")
equipBestBtn.Parent = page4
equipBestBtn.BackgroundColor3 = colors.success
equipBestBtn.Size = UDim2.new(0, 200, 0, 35)
equipBestBtn.Position = UDim2.new(0.5, -100, 0, 300)
equipBestBtn.Text = "âš¡ EQUIP BEST"
equipBestBtn.TextColor3 = colors.background
equipBestBtn.Font = Enum.Font.GothamBold
equipBestBtn.TextSize = 13

local equipBestCorner = Instance.new("UICorner")
equipBestCorner.CornerRadius = UDim.new(0, 6)
equipBestCorner.Parent = equipBestBtn

local refreshUnitsBtn = Instance.new("TextButton")
refreshUnitsBtn.Parent = page4
refreshUnitsBtn.BackgroundColor3 = colors.tertiary
refreshUnitsBtn.Size = UDim2.new(0, 200, 0, 30)
refreshUnitsBtn.Position = UDim2.new(0.5, -100, 0, 345)
refreshUnitsBtn.Text = "ðŸ”„ ATUALIZAR UNITS"
refreshUnitsBtn.TextColor3 = colors.text
refreshUnitsBtn.Font = Enum.Font.GothamBold
refreshUnitsBtn.TextSize = 11

local refreshUnitsCorner = Instance.new("UICorner")
refreshUnitsCorner.CornerRadius = UDim.new(0, 6)
refreshUnitsCorner.Parent = refreshUnitsBtn

-- PÃGINA 5: FARM
local page5 = Instance.new("Frame")
page5.Parent = content
page5.BackgroundTransparency = 1
page5.Size = UDim2.new(1, 0, 0, 200)
page5.Position = UDim2.new(0, 0, 0, 0)
page5.Visible = false

local farmTitle = Instance.new("TextLabel")
farmTitle.Parent = page5
farmTitle.BackgroundTransparency = 1
farmTitle.Size = UDim2.new(1, -20, 0, 30)
farmTitle.Position = UDim2.new(0, 10, 0, 5)
farmTitle.Text = "âš™ï¸ AUTO FARM"
farmTitle.TextColor3 = colors.accent
farmTitle.Font = Enum.Font.GothamBold
farmTitle.TextSize = 18
farmTitle.TextXAlignment = Enum.TextXAlignment.Left

local farmCard = Instance.new("Frame")
farmCard.Parent = page5
farmCard.BackgroundColor3 = colors.secondary
farmCard.Size = UDim2.new(0, 360, 0, 100)
farmCard.Position = UDim2.new(0.5, -180, 0, 40)
farmCard.BorderSizePixel = 0

local farmCardCorner = Instance.new("UICorner")
farmCardCorner.CornerRadius = UDim.new(0, 8)
farmCardCorner.Parent = farmCard

local farmInfo = Instance.new("TextLabel")
farmInfo.Parent = farmCard
farmInfo.BackgroundTransparency = 1
farmInfo.Size = UDim2.new(1, -20, 0, 40)
farmInfo.Position = UDim2.new(0, 10, 0, 5)
farmInfo.Text = "Mob selecionado: " .. (selectedMob and selectedMob.Name or "Nenhum")
farmInfo.TextColor3 = colors.textDim
farmInfo.Font = Enum.Font.Gotham
farmInfo.TextSize = 12
farmInfo.TextXAlignment = Enum.TextXAlignment.Left

local farmToggleBtn = Instance.new("TextButton")
farmToggleBtn.Parent = farmCard
farmToggleBtn.BackgroundColor3 = colors.tertiary
farmToggleBtn.Size = UDim2.new(0, 200, 0, 35)
farmToggleBtn.Position = UDim2.new(0.5, -100, 0, 55)
farmToggleBtn.Text = "â–¶ï¸ INICIAR FARM"
farmToggleBtn.TextColor3 = colors.text
farmToggleBtn.Font = Enum.Font.GothamBold
farmToggleBtn.TextSize = 13

local farmToggleCorner = Instance.new("UICorner")
farmToggleCorner.CornerRadius = UDim.new(0, 6)
farmToggleCorner.Parent = farmToggleBtn

-- ================ FUNÃ‡Ã•ES DE NAVEGAÃ‡ÃƒO ================

local function switchPage(page)
    page1.Visible = (page == 1)
    page2.Visible = (page == 2)
    page3.Visible = (page == 3)
    page4.Visible = (page == 4)
    page5.Visible = (page == 5)

    local positions = {20, 100, 180, 260, 340}
    tweenService:Create(pageIndicator, TweenInfo.new(0.3), {
        Position = UDim2.new(0, positions[page], 1, -5)
    }):Play()

    local tabs = {tab1, tab2, tab3, tab4, tab5}
    for i = 1, 5 do
        tabs[i].TextColor3 = (i == page) and colors.accent or colors.textDim
    end
    
    local pageHeight = 300
    if page == 2 then pageHeight = 300
    elseif page == 3 then pageHeight = 400
    elseif page == 4 then pageHeight = 400
    elseif page == 5 then pageHeight = 200
    end
    content.CanvasSize = UDim2.new(0, 0, 0, pageHeight)
end

tab1.MouseButton1Click:Connect(function() switchPage(1) end)
tab2.MouseButton1Click:Connect(function() switchPage(2) end)
tab3.MouseButton1Click:Connect(function() switchPage(3) end)
tab4.MouseButton1Click:Connect(function() switchPage(4) end)
tab5.MouseButton1Click:Connect(function() switchPage(5) end)

-- BotÃ£o toggle
toggleBtn.MouseButton1Click:Connect(function()
    hubVisible = not hubVisible
    mainFrame.Visible = hubVisible
end)

-- ================ FUNÃ‡Ã•ES DOS BOTÃ•ES ================

local function updateWorldInfo()
    local world, color = detectLeafWorld()
    worldName.Text = world
    worldName.TextColor3 = color
    worldStatus.Text = inLeafWorld and "âœ… No mundo certo" or "âŒ Fora do mundo"
    gems, gold = getGemsAndGold()
    gemsValue.Text = tostring(gems)
    goldValue.Text = tostring(gold)
end

local function updateStarsList()
    if not inLeafWorld then
        starsList.Text = "ðŸš« FORA DO LEAF WORLD\n\nEntre no Leaf World para ver as Stars"
        return
    end
    
    stars = findStars()
    local text = "STARS: " .. #stars .. "/6\n\n"
    if #stars == 0 then
        text = text .. "Nenhuma Star encontrada.\nProcure por objetos chamados 'Star'"
    else
        for i, star in ipairs(stars) do
            local dist = "?"
            if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                local root = player.Character.HumanoidRootPart
                dist = math.floor((root.Position - star.Position).Magnitude) .. "m"
            end
            text = text .. i .. ". " .. star.Name .. " [" .. dist .. "]\n"
        end
        selectedStar = stars[1]
        spinStarBtn.Text = "ðŸŽ¯ GIRAR " .. stars[1].Name
    end
    starsList.Text = text
end

local function updateMobsList()
    for _, child in ipairs(mobsScrolling:GetChildren()) do
        if child:IsA("TextButton") then
            child:Destroy()
        end
    end
    
    mobs = findMobs()
    
    for i, mob in ipairs(mobs) do
        local btn = Instance.new("TextButton")
        btn.Parent = mobsScrolling
        btn.BackgroundColor3 = colors.tertiary
        btn.Size = UDim2.new(0, 340, 0, 35)
        btn.Position = UDim2.new(0, 10, 0, 5 + (i-1) * 40)
        btn.Text = ""
        btn.AutoButtonColor = false
        btn.BorderSizePixel = 0
        
        local btnCorner = Instance.new("UICorner")
        btnCorner.CornerRadius = UDim.new(0, 6)
        btnCorner.Parent = btn
        
        local nameLabel = Instance.new("TextLabel")
        nameLabel.Parent = btn
        nameLabel.BackgroundTransparency = 1
        nameLabel.Size = UDim2.new(0, 150, 1, 0)
        nameLabel.Position = UDim2.new(0, 10, 0, 0)
        nameLabel.Text = mob.Name
        nameLabel.TextColor3 = mob.IsBoss and colors.warning or colors.text
        nameLabel.Font = Enum.Font.Gotham
        nameLabel.TextSize = 12
        nameLabel.TextXAlignment = Enum.TextXAlignment.Left
        
        local healthLabel = Instance.new("TextLabel")
        healthLabel.Parent = btn
        healthLabel.BackgroundTransparency = 1
        healthLabel.Size = UDim2.new(0, 100, 1, 0)
        healthLabel.Position = UDim2.new(0, 170, 0, 0)
        healthLabel.Text = math.floor(mob.Health) .. " HP"
        healthLabel.TextColor3 = mob.IsBoss and colors.warning or colors.success
        healthLabel.Font = Enum.Font.Gotham
        healthLabel.TextSize = 12
        
        local bossLabel = mob.IsBoss and Instance.new("TextLabel") or nil
        if bossLabel then
            bossLabel.Parent = btn
            bossLabel.BackgroundTransparency = 1
            bossLabel.Size = UDim2.new(0, 60, 1, 0)
            bossLabel.Position = UDim2.new(0, 280, 0, 0)
            bossLabel.Text = "BOSS"
            bossLabel.TextColor3 = colors.warning
            bossLabel.Font = Enum.Font.GothamBold
            bossLabel.TextSize = 12
        end
        
        btn.MouseButton1Click:Connect(function()
            selectedMob = mob
            selectedMobText.Text = "âœ… " .. mob.Name .. " [" .. math.floor(mob.Health) .. " HP]"
            selectedMobText.TextColor3 = mob.IsBoss and colors.warning or colors.selected
            farmInfo.Text = "Mob selecionado: " .. mob.Name
        end)
    end
    
    mobsScrolling.CanvasSize = UDim2.new(0, 0, 0, #mobs * 40 + 20)
end

local function updateUnitsList()
    for _, child in ipairs(unitsScrolling:GetChildren()) do
        if child:IsA("TextButton") then
            child:Destroy()
        end
    end
    
    units = findUnits()
    
    if #units == 0 then
        local noUnits = Instance.new("TextLabel")
        noUnits.Parent = unitsScrolling
        noUnits.BackgroundTransparency = 1
        noUnits.Size = UDim2.new(1, 0, 0, 50)
        noUnits.Position = UDim2.new(0, 0, 0, 10)
        noUnits.Text = "Nenhuma unit encontrada"
        noUnits.TextColor3 = colors.textDim
        noUnits.Font = Enum.Font.Gotham
        noUnits.TextSize = 14
        return
    end
    
    for i, unit in ipairs(units) do
        local btn = Instance.new("TextButton")
        btn.Parent = unitsScrolling
        btn.BackgroundColor3 = colors.tertiary
        btn.Size = UDim2.new(0, 340, 0, 35)
        btn.Position = UDim2.new(0, 10, 0, 5 + (i-1) * 40)
        btn.Text = ""
        btn.AutoButtonColor = false
        btn.BorderSizePixel = 0
        
        local btnCorner = Instance.new("UICorner")
        btnCorner.CornerRadius = UDim.new(0, 6)
        btnCorner.Parent = btn
        
        local nameLabel = Instance.new("TextLabel")
        nameLabel.Parent = btn
        nameLabel.BackgroundTransparency = 1
        nameLabel.Size = UDim2.new(0, 200, 1, 0)
        nameLabel.Position = UDim2.new(0, 10, 0, 0)
        nameLabel.Text = unit.Name
        nameLabel.TextColor3 = colors.text
        nameLabel.Font = Enum.Font.Gotham
        nameLabel.TextSize = 12
        nameLabel.TextXAlignment = Enum.TextXAlignment.Left
        
        local damageLabel = Instance.new("TextLabel")
        damageLabel.Parent = btn
        damageLabel.BackgroundTransparency = 1
        damageLabel.Size = UDim2.new(0, 100, 1, 0)
        damageLabel.Position = UDim2.new(0, 220, 0, 0)
        damageLabel.Text = "Dano: " .. unit.Damage
        damageLabel.TextColor3 = colors.success
        damageLabel.Font = Enum.Font.Gotham
        damageLabel.TextSize = 12
    end
    
    unitsScrolling.CanvasSize = UDim2.new(0, 0, 0, #units * 40 + 20)
end

-- ConexÃµes
refreshStarsBtn.MouseButton1Click:Connect(updateStarsList)
refreshMobsBtn.MouseButton1Click:Connect(updateMobsList)
refreshUnitsBtn.MouseButton1Click:Connect(updateUnitsList)
equipBestBtn.MouseButton1Click:Connect(equipBestUnit)

spinStarBtn.MouseButton1Click:Connect(function()
    if selectedStar then
        spinStar(selectedStar)
    end
end)

farmToggleBtn.MouseButton1Click:Connect(function()
    if farmActive then
        stopFarming()
        farmToggleBtn.Text = "â–¶ï¸ INICIAR FARM"
        farmToggleBtn.BackgroundColor3 = colors.tertiary
    else
        startFarming()
        farmToggleBtn.Text = "â¹ï¸ PARAR FARM"
        farmToggleBtn.BackgroundColor3 = colors.danger
    end
end)

-- Bypass (vamos adicionar uma pÃ¡gina simples de bypass)
local bypassToggleBtn = Instance.new("TextButton")
bypassToggleBtn.Parent = mainFrame -- VocÃª pode adicionar em uma pÃ¡gina especÃ­fica
bypassToggleBtn.BackgroundColor3 = colors.tertiary
bypassToggleBtn.Size = UDim2.new(0, 150, 0, 30)
bypassToggleBtn.Position = UDim2.new(0.5, -75, 0, 350)
bypassToggleBtn.Text = "ATIVAR BYPASS"
bypassToggleBtn.TextColor3 = colors.text
bypassToggleBtn.Font = Enum.Font.GothamBold
bypassToggleBtn.TextSize = 11

local bypassToggleCorner = Instance.new("UICorner")
bypassToggleCorner.CornerRadius = UDim.new(0, 6)
bypassToggleCorner.Parent = bypassToggleBtn

bypassToggleBtn.MouseButton1Click:Connect(function()
    toggleBypass()
    if bypassActive then
        bypassToggleBtn.Text = "BYPASS ATIVO"
        bypassToggleBtn.BackgroundColor3 = colors.success
    else
        bypassToggleBtn.Text = "ATIVAR BYPASS"
        bypassToggleBtn.BackgroundColor3 = colors.tertiary
    end
end)

-- Fechar
local closeBtn = Instance.new("TextButton")
closeBtn.Parent = topBar
closeBtn.BackgroundColor3 = colors.danger
closeBtn.Size = UDim2.new(0, 25, 0, 25)
closeBtn.Position = UDim2.new(1, -30, 0.5, -12.5)
closeBtn.Text = "âœ•"
closeBtn.TextColor3 = colors.text
closeBtn.Font = Enum.Font.GothamBold
closeBtn.TextSize = 14

local closeCorner = Instance.new("UICorner")
closeCorner.CornerRadius = UDim.new(0, 6)
closeCorner.Parent = closeBtn

closeBtn.MouseButton1Click:Connect(function()
    if farmActive then
        stopFarming()
    end
    screenGui:Destroy()
end)

-- AtualizaÃ§Ãµes automÃ¡ticas
task.spawn(function()
    while true do
        updateWorldInfo()
        if page2.Visible and inLeafWorld then
            updateStarsList()
        end
        task.wait(2)
    end
end)

task.spawn(function()
    while true do
        if page3.Visible then
            updateMobsList()
        end
        if page4.Visible then
            updateUnitsList()
        end
        task.wait(3)
    end
end)

-- InicializaÃ§Ã£o
updateWorldInfo()
updateStarsList()
updateMobsList()
updateUnitsList()
switchPage(1)

print("âœ… Stelk Hub v12.0 - Auto Farm carregado!")
