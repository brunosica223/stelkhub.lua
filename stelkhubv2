--[[
    STELK HUB - LEAF WORLD
    Vers√£o: 11.0 - FINAL EDITION
    - Tamanho 400x400 (mais compacto)
    - Bot√£o toggle para esconder/mostrar
    - Detec√ß√£o de units aprimorada
    - Movimento suave at√© mob (anti-kick)
    - Estrelas com debug
]]

local player = game.Players.LocalPlayer
local guiService = game:GetService("CoreGui")
local runService = game:GetService("RunService")
local tweenService = game:GetService("TweenService")
local userInputService = game:GetService("UserInputService")

-- ================ VARI√ÅVEIS ================

local bypassActive = false
local autoKillActive = false
local selectedMob = nil
local selectedUnit = nil
local currentWorld = "Desconhecido"
local inLeafWorld = false
local gems = 0
local gold = 0
local selectedStar = nil
local stars = {}
local mobs = {}
local units = {}
local hubVisible = true

-- ================ CORES ================

local colors = {
    background = Color3.fromRGB(18, 18, 18),
    secondary = Color3.fromRGB(30, 30, 30),
    tertiary = Color3.fromRGB(45, 45, 45),
    accent = Color3.fromRGB(255, 255, 255),
    success = Color3.fromRGB(100, 200, 100),
    danger = Color3.fromRGB(255, 80, 80),
    text = Color3.fromRGB(255, 255, 255),
    textDim = Color3.fromRGB(180, 180, 180),
    highlight = Color3.fromRGB(70, 70, 70),
    selected = Color3.fromRGB(80, 150, 255)
}

-- ================ DETEC√á√ÉO DE MUNDO ================

local function detectLeafWorld()
    local leafKeywords = {
        "leaf", "village", "konoha", "naruto", "hokage",
        "folha", "kakashi", "sasuke", "sakura", "chakra",
        "leaf world", "leaf_village", "leaf-world"
    }
    
    for _, obj in ipairs(workspace:GetDescendants()) do
        local name = obj.Name:lower()
        for _, kw in ipairs(leafKeywords) do
            if name:find(kw) then
                inLeafWorld = true
                return "üçÉ LEAF WORLD", colors.success
            end
        end
    end
    
    inLeafWorld = false
    return "‚ùå FORA DO LEAF WORLD", colors.danger
end

-- ================ DETEC√á√ÉO DE GEMS E GOLD ================

local function getGemsAndGold()
    gems = 0
    gold = 0

    if player:FindFirstChild("leaderstats") then
        for _, child in ipairs(player.leaderstats:GetChildren()) do
            local name = child.Name:lower()
            if name:find("gem") then gems = child.Value or 0 end
            if name:find("gold") or name:find("coin") then gold = child.Value or 0 end
        end
    end

    return gems, gold
end

-- ================ SISTEMA DE STARS (APRIMORADO) ================

local function findStars()
    local found = {}
    
    if not inLeafWorld then 
        print("üîç Fora do Leaf World - n√£o procurando estrelas")
        return found 
    end
    
    print("üîç Procurando Stars no Leaf World...")
    
    -- Palavras-chave expandidas
    local starKeywords = {"star", "estrela", "spin", "gacha", "roda", "wheel", "crystal"}
    
    for _, obj in ipairs(workspace:GetDescendants()) do
        local name = obj.Name:lower()
        for _, kw in ipairs(starKeywords) do
            if name:find(kw) then
                if obj:IsA("BasePart") or obj:IsA("Model") then
                    print("‚úÖ Encontrado: " .. obj.Name)
                    table.insert(found, obj)
                    break
                end
            end
        end
        
        -- Procura por ClickDetectors
        if obj:IsA("ClickDetector") and obj.Parent then
            local parentName = obj.Parent.Name:lower()
            for _, kw in ipairs(starKeywords) do
                if parentName:find(kw) then
                    print("‚úÖ Encontrado ClickDetector em: " .. obj.Parent.Name)
                    table.insert(found, obj.Parent)
                    break
                end
            end
        end
        
        if #found >= 6 then break end
    end
    
    print("üîç Total de Stars: " .. #found)
    return found
end

local function spinStar(star)
    if not star then return false end

    local detector = star:FindFirstChildOfClass("ClickDetector")
    if detector then
        fireclickdetector(detector)
        return true
    end

    local prompt = star:FindFirstChildOfClass("ProximityPrompt")
    if prompt then
        prompt:InputHoldBegin()
        task.wait(0.1)
        prompt:InputHoldEnd()
        return true
    end

    return false
end

-- ================ SISTEMA DE MOBS ================

local function findMobs()
    local found = {}
    
    for _, obj in ipairs(workspace:GetDescendants()) do
        if obj:IsA("Model") and obj:FindFirstChildOfClass("Humanoid") then
            local name = obj.Name:lower()
            if name:find("mob") or name:find("boss") or name:find("enemy") or name:find("leaf") then
                table.insert(found, obj)
            end
        end
    end
    
    return found
end

-- ================ SISTEMA DE UNITS (BUSCA PROFUNDA) ================

local function findUnits()
    local found = {}
    
    -- Fun√ß√£o recursiva para procurar em todas as pastas do jogador
    local function searchIn(container)
        if not container then return end
        for _, child in ipairs(container:GetChildren()) do
            -- Se for um modelo ou pasta, pode ser uma unit
            if child:IsA("Model") or child:IsA("Folder") or child:IsA("Configuration") then
                -- Tenta encontrar valor de dano
                local damage = 0
                local damageValue = child:FindFirstChild("Damage") or 
                                    child:FindFirstChild("Power") or 
                                    child:FindFirstChild("Atk") or
                                    child:FindFirstChild("Attack") or
                                    child:FindFirstChild("Dano")
                if damageValue and damageValue:IsA("NumberValue") then
                    damage = damageValue.Value
                end
                
                -- Se tem dano ou nome sugestivo, adiciona
                if damage > 0 or child.Name:lower():find("unit") or child.Name:lower():find("pet") then
                    table.insert(found, {
                        Name = child.Name,
                        Damage = damage,
                        Object = child
                    })
                end
                
                -- Continua procurando dentro
                searchIn(child)
            end
        end
    end
    
    -- Pastas principais para come√ßar a busca
    local roots = {
        player,
        player:FindFirstChild("PlayerGui"),
        player:FindFirstChild("Backpack"),
        player:FindFirstChild("StarterGear"),
        game:GetService("ReplicatedStorage")
    }
    
    for _, root in ipairs(roots) do
        if root then
            searchIn(root)
        end
    end
    
    -- Remove duplicatas (pelo nome e dano)
    local unique = {}
    local seen = {}
    for _, unit in ipairs(found) do
        local key = unit.Name .. "_" .. unit.Damage
        if not seen[key] then
            seen[key] = true
            table.insert(unique, unit)
        end
    end
    
    -- Ordenar por dano (maior primeiro)
    table.sort(unique, function(a, b) return a.Damage > b.Damage end)
    
    return unique
end

-- ================ EQUIPAR MELHOR UNIT ================

local function equipBestUnit()
    units = findUnits()
    
    if #units == 0 then
        print("‚ùå Nenhuma unit encontrada")
        return
    end
    
    local best = units[1]
    print("‚úÖ Melhor unit: " .. best.Name .. " (Dano: " .. best.Damage .. ")")
    
    if best.Object then
        -- Tenta remote
        local remote = player:FindFirstChild("EquipUnit") or 
                      player:FindFirstChild("SelectUnit") or
                      game:GetService("ReplicatedStorage"):FindFirstChild("EquipUnit")
        
        if remote and remote:IsA("RemoteEvent") then
            remote:FireServer(best.Object)
        end
        
        -- Tenta mover para o personagem
        if player.Character then
            best.Object.Parent = player.Character
        end
    end
end

-- ================ MOVIMENTO SUAVE AT√â MOB (ANTI-KICK) ================

local function smoothMoveToMob(mob)
    if not mob then return end
    local root = mob:FindFirstChild("HumanoidRootPart") or mob:FindFirstChild("Torso") or mob:FindFirstChild("UpperTorso")
    if not root then return end
    
    local char = player.Character
    if not char then return end
    local charRoot = char:FindFirstChild("HumanoidRootPart")
    if not charRoot then return end
    
    local targetPos = root.Position + Vector3.new(0, 5, 0)
    local distance = (targetPos - charRoot.Position).Magnitude
    
    -- Se estiver muito longe, voa r√°pido, mas n√£o teleporta
    if distance > 100 then
        -- Move com velocidade alta mas gradual
        local tweenInfo = TweenInfo.new(2, Enum.EasingStyle.Linear, Enum.EasingDirection.Out)
        local goal = {CFrame = CFrame.new(targetPos)}
        local tween = tweenService:Create(charRoot, tweenInfo, goal)
        tween:Play()
        tween.Completed:Wait()
    else
        -- Move suavemente
        local tweenInfo = TweenInfo.new(distance / 50, Enum.EasingStyle.Linear, Enum.EasingDirection.Out)
        local goal = {CFrame = CFrame.new(targetPos)}
        local tween = tweenService:Create(charRoot, tweenInfo, goal)
        tween:Play()
        tween.Completed:Wait()
    end
end

local function attackMob(mob)
    if not mob then return end
    local humanoid = mob:FindFirstChildOfClass("Humanoid")
    if humanoid and humanoid.Health > 0 then
        -- Dano direto (pode ser ajustado)
        humanoid.Health = humanoid.Health - 1000
    end
end

local function startAutoKill()
    if not selectedMob then
        print("‚ùå Selecione um mob primeiro")
        return
    end
    
    autoKillActive = true
    print("‚öîÔ∏è Auto Kill ativado para: " .. selectedMob.Name)
    
    task.spawn(function()
        while autoKillActive and selectedMob and selectedMob.Parent do
            smoothMoveToMob(selectedMob)
            attackMob(selectedMob)
            task.wait(1)
        end
        autoKillActive = false
        print("‚èπÔ∏è Auto Kill parado")
    end)
end

local function stopAutoKill()
    autoKillActive = false
end

-- ================ BYPASS ================

local function toggleBypass()
    if bypassActive then
        bypassActive = false
        return
    end

    bypassActive = true

    pcall(function()
        local mt = getrawmetatable and getrawmetatable(game) or getmetatable(game)
        if mt then
            local oldNamecall = mt.__namecall
            setreadonly(mt, false)

            mt.__namecall = newcclosure(function(self, ...)
                local method = getnamecallmethod()
                if method == "FireServer" then
                    local remoteName = tostring(self):lower()
                    if remoteName:find("anticheat") then
                        return
                    end
                end
                return oldNamecall(self, ...)
            end)
            setreadonly(mt, true)
        end
    end)
end

-- ================ CRIAR GUI (400x400) ================

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "StelkHub"
screenGui.Parent = player:WaitForChild("PlayerGui")
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- Bot√£o toggle (sempre vis√≠vel)
local toggleBtn = Instance.new("TextButton")
toggleBtn.Parent = screenGui
toggleBtn.BackgroundColor3 = colors.accent
toggleBtn.Size = UDim2.new(0, 40, 0, 40)
toggleBtn.Position = UDim2.new(0, 10, 0, 10)
toggleBtn.Text = "‚â°"
toggleBtn.TextColor3 = colors.background
toggleBtn.Font = Enum.Font.GothamBold
toggleBtn.TextSize = 24
toggleBtn.BorderSizePixel = 0

local toggleCorner = Instance.new("UICorner")
toggleCorner.CornerRadius = UDim.new(0, 8)
toggleCorner.Parent = toggleBtn

-- Frame principal (400x400)
local mainFrame = Instance.new("Frame")
mainFrame.Parent = screenGui
mainFrame.BackgroundColor3 = colors.background
mainFrame.BorderSizePixel = 0
mainFrame.Size = UDim2.new(0, 400, 0, 400)
mainFrame.Position = UDim2.new(0.5, -200, 0.5, -200)
mainFrame.Active = true
mainFrame.Draggable = true
mainFrame.Visible = true

-- Top Bar (40px)
local topBar = Instance.new("Frame")
topBar.Parent = mainFrame
topBar.BackgroundColor3 = colors.secondary
topBar.Size = UDim2.new(1, 0, 0, 40)
topBar.BorderSizePixel = 0

local title = Instance.new("TextLabel")
title.Parent = topBar
title.BackgroundTransparency = 1
title.Size = UDim2.new(0, 200, 1, 0)
title.Position = UDim2.new(0, 10, 0, 0)
title.Text = "STELK HUB"
title.TextColor3 = colors.accent
title.Font = Enum.Font.GothamBold
title.TextSize = 18
title.TextXAlignment = Enum.TextXAlignment.Left

-- Abas rol√°veis
local tabContainer = Instance.new("Frame")
tabContainer.Parent = mainFrame
tabContainer.BackgroundColor3 = colors.secondary
tabContainer.Size = UDim2.new(1, 0, 0, 35)
tabContainer.Position = UDim2.new(0, 0, 0, 40)
tabContainer.ClipsDescendants = true

local tabScrolling = Instance.new("ScrollingFrame")
tabScrolling.Parent = tabContainer
tabScrolling.BackgroundTransparency = 1
tabScrolling.Size = UDim2.new(1, 0, 1, 0)
tabScrolling.CanvasSize = UDim2.new(2.5, 0, 0, 0)
tabScrolling.ScrollBarThickness = 0
tabScrolling.BorderSizePixel = 0

local function createTab(name, pos)
    local btn = Instance.new("TextButton")
    btn.Parent = tabScrolling
    btn.BackgroundColor3 = colors.background
    btn.Size = UDim2.new(0, 70, 0, 25)
    btn.Position = UDim2.new(0, pos, 0.5, -12.5)
    btn.Text = name
    btn.TextColor3 = colors.textDim
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 12
    btn.AutoButtonColor = false
    btn.BorderSizePixel = 0
    return btn
end

local tab1 = createTab("MUNDO", 10)
local tab2 = createTab("STARS", 90)
local tab3 = createTab("MOBS", 170)
local tab4 = createTab("UNITS", 250)
local tab5 = createTab("BYPASS", 330)

local pageIndicator = Instance.new("Frame")
pageIndicator.Parent = tabScrolling
pageIndicator.BackgroundColor3 = colors.accent
pageIndicator.Size = UDim2.new(0, 50, 0, 2)
pageIndicator.Position = UDim2.new(0, 20, 1, -5)
pageIndicator.BorderSizePixel = 0

-- Conte√∫do (com scroll)
local content = Instance.new("ScrollingFrame")
content.Parent = mainFrame
content.BackgroundColor3 = colors.background
content.Size = UDim2.new(1, -20, 1, -95)
content.Position = UDim2.new(0, 10, 0, 85)
content.CanvasSize = UDim2.new(0, 0, 2, 0)
content.ScrollBarThickness = 4
content.BorderSizePixel = 0

local contentCorner = Instance.new("UICorner")
contentCorner.CornerRadius = UDim.new(0, 8)
contentCorner.Parent = content

-- P√ÅGINA 1: MUNDO (altura reduzida)
local page1 = Instance.new("Frame")
page1.Parent = content
page1.BackgroundTransparency = 1
page1.Size = UDim2.new(1, 0, 0, 250)
page1.Position = UDim2.new(0, 0, 0, 0)
page1.Visible = true

local worldCard = Instance.new("Frame")
worldCard.Parent = page1
worldCard.BackgroundColor3 = colors.secondary
worldCard.Size = UDim2.new(0, 360, 0, 70)
worldCard.Position = UDim2.new(0.5, -180, 0, 10)
worldCard.BorderSizePixel = 0

local worldCardCorner = Instance.new("UICorner")
worldCardCorner.CornerRadius = UDim.new(0, 8)
worldCardCorner.Parent = worldCard

local worldIcon = Instance.new("TextLabel")
worldIcon.Parent = worldCard
worldIcon.BackgroundTransparency = 1
worldIcon.Size = UDim2.new(0, 40, 1, 0)
worldIcon.Position = UDim2.new(0, 10, 0, 0)
worldIcon.Text = "üçÉ"
worldIcon.TextColor3 = colors.accent
worldIcon.Font = Enum.Font.GothamBold
worldIcon.TextSize = 28

local worldName = Instance.new("TextLabel")
worldName.Parent = worldCard
worldName.BackgroundTransparency = 1
worldName.Size = UDim2.new(0, 250, 0, 25)
worldName.Position = UDim2.new(0, 60, 0, 10)
worldName.Text = "Detectando..."
worldName.TextColor3 = colors.accent
worldName.Font = Enum.Font.GothamBold
worldName.TextSize = 15
worldName.TextXAlignment = Enum.TextXAlignment.Left

local worldStatus = Instance.new("TextLabel")
worldStatus.Parent = worldCard
worldStatus.BackgroundTransparency = 1
worldStatus.Size = UDim2.new(0, 250, 0, 20)
worldStatus.Position = UDim2.new(0, 60, 0, 40)
worldStatus.Text = "Aguardando..."
worldStatus.TextColor3 = colors.textDim
worldStatus.Font = Enum.Font.Gotham
worldStatus.TextSize = 11
worldStatus.TextXAlignment = Enum.TextXAlignment.Left

local resourcesCard = Instance.new("Frame")
resourcesCard.Parent = page1
resourcesCard.BackgroundColor3 = colors.secondary
resourcesCard.Size = UDim2.new(0, 360, 0, 60)
resourcesCard.Position = UDim2.new(0.5, -180, 0, 90)
resourcesCard.BorderSizePixel = 0

local resourcesCorner = Instance.new("UICorner")
resourcesCorner.CornerRadius = UDim.new(0, 8)
resourcesCorner.Parent = resourcesCard

local gemsFrame = Instance.new("Frame")
gemsFrame.Parent = resourcesCard
gemsFrame.BackgroundColor3 = colors.tertiary
gemsFrame.Size = UDim2.new(0, 160, 0, 40)
gemsFrame.Position = UDim2.new(0, 15, 0.5, -20)
gemsFrame.BorderSizePixel = 0

local gemsCorner = Instance.new("UICorner")
gemsCorner.CornerRadius = UDim.new(0, 6)
gemsCorner.Parent = gemsFrame

local gemsIcon = Instance.new("TextLabel")
gemsIcon.Parent = gemsFrame
gemsIcon.BackgroundTransparency = 1
gemsIcon.Size = UDim2.new(0, 30, 1, 0)
gemsIcon.Position = UDim2.new(0, 5, 0, 0)
gemsIcon.Text = "üíé"
gemsIcon.TextColor3 = colors.accent
gemsIcon.Font = Enum.Font.GothamBold
gemsIcon.TextSize = 18

local gemsValue = Instance.new("TextLabel")
gemsValue.Parent = gemsFrame
gemsValue.BackgroundTransparency = 1
gemsValue.Size = UDim2.new(0, 110, 0, 25)
gemsValue.Position = UDim2.new(0, 40, 0.5, -12.5)
gemsValue.Text = "0"
gemsValue.TextColor3 = colors.accent
gemsValue.Font = Enum.Font.GothamBold
gemsValue.TextSize = 15
gemsValue.TextXAlignment = Enum.TextXAlignment.Left

local goldFrame = Instance.new("Frame")
goldFrame.Parent = resourcesCard
goldFrame.BackgroundColor3 = colors.tertiary
goldFrame.Size = UDim2.new(0, 160, 0, 40)
goldFrame.Position = UDim2.new(1, -175, 0.5, -20)
goldFrame.BorderSizePixel = 0

local goldCorner = Instance.new("UICorner")
goldCorner.CornerRadius = UDim.new(0, 6)
goldCorner.Parent = goldFrame

local goldIcon = Instance.new("TextLabel")
goldIcon.Parent = goldFrame
goldIcon.BackgroundTransparency = 1
goldIcon.Size = UDim2.new(0, 30, 1, 0)
goldIcon.Position = UDim2.new(0, 5, 0, 0)
goldIcon.Text = "ü™ô"
goldIcon.TextColor3 = colors.accent
goldIcon.Font = Enum.Font.GothamBold
goldIcon.TextSize = 18

local goldValue = Instance.new("TextLabel")
goldValue.Parent = goldFrame
goldValue.BackgroundTransparency = 1
goldValue.Size = UDim2.new(0, 110, 0, 25)
goldValue.Position = UDim2.new(0, 40, 0.5, -12.5)
goldValue.Text = "0"
goldValue.TextColor3 = colors.accent
goldValue.Font = Enum.Font.GothamBold
goldValue.TextSize = 15
goldValue.TextXAlignment = Enum.TextXAlignment.Left

-- P√ÅGINA 2: STARS (com debug)
local page2 = Instance.new("Frame")
page2.Parent = content
page2.BackgroundTransparency = 1
page2.Size = UDim2.new(1, 0, 0, 300)
page2.Position = UDim2.new(0, 0, 0, 0)
page2.Visible = false

local starsTitle = Instance.new("TextLabel")
starsTitle.Parent = page2
starsTitle.BackgroundTransparency = 1
starsTitle.Size = UDim2.new(1, -20, 0, 30)
starsTitle.Position = UDim2.new(0, 10, 0, 5)
starsTitle.Text = "‚≠ê STARS"
starsTitle.TextColor3 = colors.accent
starsTitle.Font = Enum.Font.GothamBold
starsTitle.TextSize = 18
starsTitle.TextXAlignment = Enum.TextXAlignment.Left

local starsList = Instance.new("TextLabel")
starsList.Parent = page2
starsList.BackgroundColor3 = colors.secondary
starsList.Size = UDim2.new(0, 360, 0, 120)
starsList.Position = UDim2.new(0.5, -180, 0, 40)
starsList.Text = "Aguardando...\nEntre no Leaf World"
starsList.TextColor3 = colors.textDim
starsList.Font = Enum.Font.Gotham
starsList.TextSize = 12
starsList.TextWrapped = true
starsList.TextXAlignment = Enum.TextXAlignment.Left
starsList.TextYAlignment = Enum.TextYAlignment.Top

local starsCorner = Instance.new("UICorner")
starsCorner.CornerRadius = UDim.new(0, 8)
starsCorner.Parent = starsList

local refreshStarsBtn = Instance.new("TextButton")
refreshStarsBtn.Parent = page2
refreshStarsBtn.BackgroundColor3 = colors.tertiary
refreshStarsBtn.Size = UDim2.new(0, 100, 0, 30)
refreshStarsBtn.Position = UDim2.new(0.5, -160, 0, 170)
refreshStarsBtn.Text = "üîÑ ATUALIZAR"
refreshStarsBtn.TextColor3 = colors.text
refreshStarsBtn.Font = Enum.Font.GothamBold
refreshStarsBtn.TextSize = 11

local refreshCorner = Instance.new("UICorner")
refreshCorner.CornerRadius = UDim.new(0, 6)
refreshCorner.Parent = refreshStarsBtn

local spinStarBtn = Instance.new("TextButton")
spinStarBtn.Parent = page2
spinStarBtn.BackgroundColor3 = colors.tertiary
spinStarBtn.Size = UDim2.new(0, 100, 0, 30)
spinStarBtn.Position = UDim2.new(0.5, -50, 0, 170)
spinStarBtn.Text = "üéØ GIRAR #1"
spinStarBtn.TextColor3 = colors.text
spinStarBtn.Font = Enum.Font.GothamBold
spinStarBtn.TextSize = 11

local spinCorner = Instance.new("UICorner")
spinCorner.CornerRadius = UDim.new(0, 6)
spinCorner.Parent = spinStarBtn

local autoSpinBtn = Instance.new("TextButton")
autoSpinBtn.Parent = page2
autoSpinBtn.BackgroundColor3 = colors.tertiary
autoSpinBtn.Size = UDim2.new(0, 100, 0, 30)
autoSpinBtn.Position = UDim2.new(0.5, 60, 0, 170)
autoSpinBtn.Text = "‚ö° AUTO SPIN"
autoSpinBtn.TextColor3 = colors.text
autoSpinBtn.Font = Enum.Font.GothamBold
autoSpinBtn.TextSize = 11

local autoCorner = Instance.new("UICorner")
autoCorner.CornerRadius = UDim.new(0, 6)
autoCorner.Parent = autoSpinBtn

-- P√ÅGINA 3: MOBS (com indicador)
local page3 = Instance.new("Frame")
page3.Parent = content
page3.BackgroundTransparency = 1
page3.Size = UDim2.new(1, 0, 0, 450)
page3.Position = UDim2.new(0, 0, 0, 0)
page3.Visible = false

local mobsTitle = Instance.new("TextLabel")
mobsTitle.Parent = page3
mobsTitle.BackgroundTransparency = 1
mobsTitle.Size = UDim2.new(1, -20, 0, 30)
mobsTitle.Position = UDim2.new(0, 10, 0, 5)
mobsTitle.Text = "üëæ MOBS"
mobsTitle.TextColor3 = colors.accent
mobsTitle.Font = Enum.Font.GothamBold
mobsTitle.TextSize = 18
mobsTitle.TextXAlignment = Enum.TextXAlignment.Left

local mobsScrolling = Instance.new("ScrollingFrame")
mobsScrolling.Parent = page3
mobsScrolling.BackgroundColor3 = colors.secondary
mobsScrolling.Size = UDim2.new(0, 360, 0, 180)
mobsScrolling.Position = UDim2.new(0.5, -180, 0, 40)
mobsScrolling.CanvasSize = UDim2.new(0, 0, 2, 0)
mobsScrolling.ScrollBarThickness = 4
mobsScrolling.BorderSizePixel = 0

local mobsCorner = Instance.new("UICorner")
mobsCorner.CornerRadius = UDim.new(0, 8)
mobsCorner.Parent = mobsScrolling

local function createMobButton(mob, index)
    local btn = Instance.new("TextButton")
    btn.Parent = mobsScrolling
    btn.BackgroundColor3 = colors.tertiary
    btn.Size = UDim2.new(0, 340, 0, 35)
    btn.Position = UDim2.new(0, 10, 0, 5 + (index-1) * 40)
    btn.Text = ""
    btn.AutoButtonColor = false
    btn.BorderSizePixel = 0
    btn.Name = "MobBtn_" .. index
    
    local btnCorner = Instance.new("UICorner")
    btnCorner.CornerRadius = UDim.new(0, 6)
    btnCorner.Parent = btn
    
    -- Indicador de sele√ß√£o
    local selectIndicator = Instance.new("Frame")
    selectIndicator.Parent = btn
    selectIndicator.BackgroundColor3 = colors.textDim
    selectIndicator.Size = UDim2.new(0, 8, 0, 8)
    selectIndicator.Position = UDim2.new(0, 8, 0.5, -4)
    selectIndicator.BorderSizePixel = 0
    
    local indicatorCorner = Instance.new("UICorner")
    indicatorCorner.CornerRadius = UDim.new(1, 0)
    indicatorCorner.Parent = selectIndicator
    
    local nameLabel = Instance.new("TextLabel")
    nameLabel.Parent = btn
    nameLabel.BackgroundTransparency = 1
    nameLabel.Size = UDim2.new(0, 150, 1, 0)
    nameLabel.Position = UDim2.new(0, 25, 0, 0)
    nameLabel.Text = mob.Name
    nameLabel.TextColor3 = colors.text
    nameLabel.Font = Enum.Font.Gotham
    nameLabel.TextSize = 12
    nameLabel.TextXAlignment = Enum.TextXAlignment.Left
    
    local dist = "?"
    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") and mob:FindFirstChild("HumanoidRootPart") then
        local root = player.Character.HumanoidRootPart
        local mobRoot = mob:FindFirstChild("HumanoidRootPart")
        dist = math.floor((root.Position - mobRoot.Position).Magnitude) .. "m"
    end
    
    local distLabel = Instance.new("TextLabel")
    distLabel.Parent = btn
    distLabel.BackgroundTransparency = 1
    distLabel.Size = UDim2.new(0, 70, 1, 0)
    distLabel.Position = UDim2.new(0, 180, 0, 0)
    distLabel.Text = dist
    distLabel.TextColor3 = colors.textDim
    distLabel.Font = Enum.Font.Gotham
    distLabel.TextSize = 12
    
    local health = mob:FindFirstChildOfClass("Humanoid") and math.floor(mob:FindFirstChildOfClass("Humanoid").Health) or 0
    local healthLabel = Instance.new("TextLabel")
    healthLabel.Parent = btn
    healthLabel.BackgroundTransparency = 1
    healthLabel.Size = UDim2.new(0, 80, 1, 0)
    healthLabel.Position = UDim2.new(0, 250, 0, 0)
    healthLabel.Text = health .. " HP"
    healthLabel.TextColor3 = colors.success
    healthLabel.Font = Enum.Font.Gotham
    healthLabel.TextSize = 12
    
    btn.MouseButton1Click:Connect(function()
        for _, child in ipairs(mobsScrolling:GetChildren()) do
            if child:IsA("TextButton") then
                local ind = child:FindFirstChildOfClass("Frame")
                if ind then
                    ind.BackgroundColor3 = colors.textDim
                end
            end
        end
        selectIndicator.BackgroundColor3 = colors.selected
        selectedMob = mob
        selectedMobText.Text = "‚úÖ " .. mob.Name .. " [" .. health .. " HP]"
        selectedMobText.TextColor3 = colors.selected
    end)
end

local selectedMobFrame = Instance.new("Frame")
selectedMobFrame.Parent = page3
selectedMobFrame.BackgroundColor3 = colors.tertiary
selectedMobFrame.Size = UDim2.new(0, 360, 0, 35)
selectedMobFrame.Position = UDim2.new(0.5, -180, 0, 230)
selectedMobFrame.BorderSizePixel = 0

local selectedCorner = Instance.new("UICorner")
selectedCorner.CornerRadius = UDim.new(0, 6)
selectedCorner.Parent = selectedMobFrame

local selectedMobText = Instance.new("TextLabel")
selectedMobText.Parent = selectedMobFrame
selectedMobText.BackgroundTransparency = 1
selectedMobText.Size = UDim2.new(1, -10, 1, 0)
selectedMobText.Position = UDim2.new(0, 10, 0, 0)
selectedMobText.Text = "Nenhum mob selecionado"
selectedMobText.TextColor3 = colors.textDim
selectedMobText.Font = Enum.Font.Gotham
selectedMobText.TextSize = 12
selectedMobText.TextXAlignment = Enum.TextXAlignment.Left

local killMobBtn = Instance.new("TextButton")
killMobBtn.Parent = page3
killMobBtn.BackgroundColor3 = colors.danger
killMobBtn.Size = UDim2.new(0, 160, 0, 35)
killMobBtn.Position = UDim2.new(0.5, -170, 0, 275)
killMobBtn.Text = "üíÄ KILL"
killMobBtn.TextColor3 = colors.text
killMobBtn.Font = Enum.Font.GothamBold
killMobBtn.TextSize = 13

local killCorner = Instance.new("UICorner")
killCorner.CornerRadius = UDim.new(0, 6)
killCorner.Parent = killMobBtn

local autoKillBtn = Instance.new("TextButton")
autoKillBtn.Parent = page3
autoKillBtn.BackgroundColor3 = colors.tertiary
autoKillBtn.Size = UDim2.new(0, 160, 0, 35)
autoKillBtn.Position = UDim2.new(0.5, 10, 0, 275)
autoKillBtn.Text = "‚öîÔ∏è AUTO KILL"
autoKillBtn.TextColor3 = colors.text
autoKillBtn.Font = Enum.Font.GothamBold
autoKillBtn.TextSize = 13

local autoKillCorner = Instance.new("UICorner")
autoKillCorner.CornerRadius = UDim.new(0, 6)
autoKillCorner.Parent = autoKillBtn

local refreshMobsBtn = Instance.new("TextButton")
refreshMobsBtn.Parent = page3
refreshMobsBtn.BackgroundColor3 = colors.tertiary
refreshMobsBtn.Size = UDim2.new(0, 330, 0, 30)
refreshMobsBtn.Position = UDim2.new(0.5, -165, 0, 320)
refreshMobsBtn.Text = "üîÑ ATUALIZAR MOBS"
refreshMobsBtn.TextColor3 = colors.text
refreshMobsBtn.Font = Enum.Font.GothamBold
refreshMobsBtn.TextSize = 11

local refreshMobsCorner = Instance.new("UICorner")
refreshMobsCorner.CornerRadius = UDim.new(0, 6)
refreshMobsCorner.Parent = refreshMobsBtn

-- P√ÅGINA 4: UNITS
local page4 = Instance.new("Frame")
page4.Parent = content
page4.BackgroundTransparency = 1
page4.Size = UDim2.new(1, 0, 0, 450)
page4.Position = UDim2.new(0, 0, 0, 0)
page4.Visible = false

local unitsTitle = Instance.new("TextLabel")
unitsTitle.Parent = page4
unitsTitle.BackgroundTransparency = 1
unitsTitle.Size = UDim2.new(1, -20, 0, 30)
unitsTitle.Position = UDim2.new(0, 10, 0, 5)
unitsTitle.Text = "‚öîÔ∏è UNITS"
unitsTitle.TextColor3 = colors.accent
unitsTitle.Font = Enum.Font.GothamBold
unitsTitle.TextSize = 18
unitsTitle.TextXAlignment = Enum.TextXAlignment.Left

local unitsScrolling = Instance.new("ScrollingFrame")
unitsScrolling.Parent = page4
unitsScrolling.BackgroundColor3 = colors.secondary
unitsScrolling.Size = UDim2.new(0, 360, 0, 250)
unitsScrolling.Position = UDim2.new(0.5, -180, 0, 40)
unitsScrolling.CanvasSize = UDim2.new(0, 0, 2, 0)
unitsScrolling.ScrollBarThickness = 4
unitsScrolling.BorderSizePixel = 0

local unitsCorner = Instance.new("UICorner")
unitsCorner.CornerRadius = UDim.new(0, 8)
unitsCorner.Parent = unitsScrolling

local function updateUnitsList()
    for _, child in ipairs(unitsScrolling:GetChildren()) do
        if child:IsA("TextButton") then
            child:Destroy()
        end
    end
    
    units = findUnits()
    
    if #units == 0 then
        local noUnits = Instance.new("TextLabel")
        noUnits.Parent = unitsScrolling
        noUnits.BackgroundTransparency = 1
        noUnits.Size = UDim2.new(1, 0, 0, 50)
        noUnits.Position = UDim2.new(0, 0, 0, 10)
        noUnits.Text = "Nenhuma unit encontrada"
        noUnits.TextColor3 = colors.textDim
        noUnits.Font = Enum.Font.Gotham
        noUnits.TextSize = 14
        return
    end
    
    for i, unit in ipairs(units) do
        local btn = Instance.new("TextButton")
        btn.Parent = unitsScrolling
        btn.BackgroundColor3 = colors.tertiary
        btn.Size = UDim2.new(0, 340, 0, 35)
        btn.Position = UDim2.new(0, 10, 0, 5 + (i-1) * 40)
        btn.Text = ""
        btn.AutoButtonColor = false
        btn.BorderSizePixel = 0
        
        local btnCorner = Instance.new("UICorner")
        btnCorner.CornerRadius = UDim.new(0, 6)
        btnCorner.Parent = btn
        
        local nameLabel = Instance.new("TextLabel")
        nameLabel.Parent = btn
        nameLabel.BackgroundTransparency = 1
        nameLabel.Size = UDim2.new(0, 200, 1, 0)
        nameLabel.Position = UDim2.new(0, 10, 0, 0)
        nameLabel.Text = unit.Name
        nameLabel.TextColor3 = colors.text
        nameLabel.Font = Enum.Font.Gotham
        nameLabel.TextSize = 12
        nameLabel.TextXAlignment = Enum.TextXAlignment.Left
        
        local damageLabel = Instance.new("TextLabel")
        damageLabel.Parent = btn
        damageLabel.BackgroundTransparency = 1
        damageLabel.Size = UDim2.new(0, 100, 1, 0)
        damageLabel.Position = UDim2.new(0, 220, 0, 0)
        damageLabel.Text = "Dano: " .. unit.Damage
        damageLabel.TextColor3 = colors.success
        damageLabel.Font = Enum.Font.Gotham
        damageLabel.TextSize = 12
        
        btn.MouseButton1Click:Connect(function()
            selectedUnit = unit
        end)
    end
    
    unitsScrolling.CanvasSize = UDim2.new(0, 0, 0, #units * 40 + 20)
end

local equipBestBtn = Instance.new("TextButton")
equipBestBtn.Parent = page4
equipBestBtn.BackgroundColor3 = colors.success
equipBestBtn.Size = UDim2.new(0, 200, 0, 35)
equipBestBtn.Position = UDim2.new(0.5, -100, 0, 300)
equipBestBtn.Text = "‚ö° EQUIP BEST"
equipBestBtn.TextColor3 = colors.background
equipBestBtn.Font = Enum.Font.GothamBold
equipBestBtn.TextSize = 13

local equipBestCorner = Instance.new("UICorner")
equipBestCorner.CornerRadius = UDim.new(0, 6)
equipBestCorner.Parent = equipBestBtn

equipBestBtn.MouseButton1Click:Connect(equipBestUnit)

local refreshUnitsBtn = Instance.new("TextButton")
refreshUnitsBtn.Parent = page4
refreshUnitsBtn.BackgroundColor3 = colors.tertiary
refreshUnitsBtn.Size = UDim2.new(0, 200, 0, 30)
refreshUnitsBtn.Position = UDim2.new(0.5, -100, 0, 345)
refreshUnitsBtn.Text = "üîÑ ATUALIZAR UNITS"
refreshUnitsBtn.TextColor3 = colors.text
refreshUnitsBtn.Font = Enum.Font.GothamBold
refreshUnitsBtn.TextSize = 11

local refreshUnitsCorner = Instance.new("UICorner")
refreshUnitsCorner.CornerRadius = UDim.new(0, 6)
refreshUnitsCorner.Parent = refreshUnitsBtn

refreshUnitsBtn.MouseButton1Click:Connect(updateUnitsList)

-- P√ÅGINA 5: BYPASS
local page5 = Instance.new("Frame")
page5.Parent = content
page5.BackgroundTransparency = 1
page5.Size = UDim2.new(1, 0, 0, 150)
page5.Position = UDim2.new(0, 0, 0, 0)
page5.Visible = false

local bypassTitle = Instance.new("TextLabel")
bypassTitle.Parent = page5
bypassTitle.BackgroundTransparency = 1
bypassTitle.Size = UDim2.new(1, -20, 0, 30)
bypassTitle.Position = UDim2.new(0, 10, 0, 5)
bypassTitle.Text = "üõ°Ô∏è BYPASS"
bypassTitle.TextColor3 = colors.accent
bypassTitle.Font = Enum.Font.GothamBold
bypassTitle.TextSize = 18
bypassTitle.TextXAlignment = Enum.TextXAlignment.Left

local bypassCard = Instance.new("Frame")
bypassCard.Parent = page5
bypassCard.BackgroundColor3 = colors.secondary
bypassCard.Size = UDim2.new(0, 360, 0, 80)
bypassCard.Position = UDim2.new(0.5, -180, 0, 40)
bypassCard.BorderSizePixel = 0

local bypassCardCorner = Instance.new("UICorner")
bypassCardCorner.CornerRadius = UDim.new(0, 8)
bypassCardCorner.Parent = bypassCard

local bypassInfo = Instance.new("TextLabel")
bypassInfo.Parent = bypassCard
bypassInfo.BackgroundTransparency = 1
bypassInfo.Size = UDim2.new(1, -20, 0, 30)
bypassInfo.Position = UDim2.new(0, 10, 0, 5)
bypassInfo.Text = "‚úì Bloqueia detec√ß√£o | Prote√ß√£o contra kick"
bypassInfo.TextColor3 = colors.textDim
bypassInfo.Font = Enum.Font.Gotham
bypassInfo.TextSize = 11
bypassInfo.TextXAlignment = Enum.TextXAlignment.Left

local bypassToggleBtn = Instance.new("TextButton")
bypassToggleBtn.Parent = bypassCard
bypassToggleBtn.BackgroundColor3 = colors.tertiary
bypassToggleBtn.Size = UDim2.new(0, 150, 0, 30)
bypassToggleBtn.Position = UDim2.new(0.5, -75, 0, 45)
bypassToggleBtn.Text = "ATIVAR BYPASS"
bypassToggleBtn.TextColor3 = colors.text
bypassToggleBtn.Font = Enum.Font.GothamBold
bypassToggleBtn.TextSize = 11

local bypassToggleCorner = Instance.new("UICorner")
bypassToggleCorner.CornerRadius = UDim.new(0, 6)
bypassToggleCorner.Parent = bypassToggleBtn

local bypassStatus = Instance.new("TextLabel")
bypassStatus.Parent = page5
bypassStatus.BackgroundColor3 = colors.tertiary
bypassStatus.Size = UDim2.new(0, 200, 0, 25)
bypassStatus.Position = UDim2.new(0.5, -100, 0, 120)
bypassStatus.Text = "Status: Inativo"
bypassStatus.TextColor3 = colors.textDim
bypassStatus.Font = Enum.Font.Gotham
bypassStatus.TextSize = 11

local bypassStatusCorner = Instance.new("UICorner")
bypassStatusCorner.CornerRadius = UDim.new(0, 6)
bypassStatusCorner.Parent = bypassStatus

-- ================ FUN√á√ïES DE NAVEGA√á√ÉO ================

local function switchPage(page)
    page1.Visible = (page == 1)
    page2.Visible = (page == 2)
    page3.Visible = (page == 3)
    page4.Visible = (page == 4)
    page5.Visible = (page == 5)

    local positions = {20, 100, 180, 260, 340}
    tweenService:Create(pageIndicator, TweenInfo.new(0.3), {
        Position = UDim2.new(0, positions[page], 1, -5)
    }):Play()

    local tabs = {tab1, tab2, tab3, tab4, tab5}
    for i = 1, 5 do
        tabs[i].TextColor3 = (i == page) and colors.accent or colors.textDim
    end
    
    local pageHeight = 300
    if page == 2 then pageHeight = 300
    elseif page == 3 then pageHeight = 450
    elseif page == 4 then pageHeight = 450
    elseif page == 5 then pageHeight = 150
    end
    content.CanvasSize = UDim2.new(0, 0, 0, pageHeight)
end

tab1.MouseButton1Click:Connect(function() switchPage(1) end)
tab2.MouseButton1Click:Connect(function() switchPage(2) end)
tab3.MouseButton1Click:Connect(function() switchPage(3) end)
tab4.MouseButton1Click:Connect(function() switchPage(4) end)
tab5.MouseButton1Click:Connect(function() switchPage(5) end)

-- Bot√£o toggle
toggleBtn.MouseButton1Click:Connect(function()
    hubVisible = not hubVisible
    mainFrame.Visible = hubVisible
end)

-- ================ FUN√á√ïES DOS BOT√ïES ================

local function updateWorldInfo()
    local world, color = detectLeafWorld()
    worldName.Text = world
    worldName.TextColor3 = color
    worldStatus.Text = inLeafWorld and "‚úÖ No mundo certo" or "‚ùå Fora do mundo"
    gems, gold = getGemsAndGold()
    gemsValue.Text = tostring(gems)
    goldValue.Text = tostring(gold)
end

local function updateStarsList()
    if not inLeafWorld then
        starsList.Text = "üö´ FORA DO LEAF WORLD\n\nEntre no Leaf World para ver as Stars"
        return
    end
    
    stars = findStars()
    local text = "STARS: " .. #stars .. "/6\n\n"
    if #stars == 0 then
        text = text .. "Nenhuma Star encontrada.\nUse o bot√£o DEBUG no console."
    else
        for i, star in ipairs(stars) do
            local dist = "?"
            if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                local root = player.Character.HumanoidRootPart
                dist = math.floor((root.Position - star.Position).Magnitude) .. "m"
            end
            text = text .. i .. ". " .. star.Name .. " [" .. dist .. "]\n"
        end
        selectedStar = stars[1]
        spinStarBtn.Text = "üéØ GIRAR " .. stars[1].Name
    end
    starsList.Text = text
end

local function updateMobsList()
    for _, child in ipairs(mobsScrolling:GetChildren()) do
        if child:IsA("TextButton") then
            child:Destroy()
        end
    end
    
    mobs = findMobs()
    for i, mob in ipairs(mobs) do
        createMobButton(mob, i)
    end
    
    mobsScrolling.CanvasSize = UDim2.new(0, 0, 0, #mobs * 40 + 20)
end

local function killSelectedMob()
    if not selectedMob then
        selectedMobText.Text = "‚ùå Selecione um mob"
        selectedMobText.TextColor3 = colors.danger
        return
    end
    local humanoid = selectedMob:FindFirstChildOfClass("Humanoid")
    if humanoid then
        humanoid.Health = 0
        selectedMobText.Text = "‚úÖ Mob morto: " .. selectedMob.Name
        updateMobsList()
    end
end

-- Conex√µes
refreshStarsBtn.MouseButton1Click:Connect(updateStarsList)
refreshMobsBtn.MouseButton1Click:Connect(updateMobsList)
killMobBtn.MouseButton1Click:Connect(killSelectedMob)

autoKillBtn.MouseButton1Click:Connect(function()
    if autoKillActive then
        stopAutoKill()
        autoKillBtn.Text = "‚öîÔ∏è AUTO KILL"
        autoKillBtn.BackgroundColor3 = colors.tertiary
    else
        startAutoKill()
        autoKillBtn.Text = "‚èπÔ∏è PARAR KILL"
        autoKillBtn.BackgroundColor3 = colors.danger
    end
end)

bypassToggleBtn.MouseButton1Click:Connect(function()
    toggleBypass()
    if bypassActive then
        bypassToggleBtn.Text = "BYPASS ATIVO"
        bypassToggleBtn.BackgroundColor3 = colors.success
        bypassStatus.Text = "Status: Ativo"
        bypassStatus.TextColor3 = colors.success
    else
        bypassToggleBtn.Text = "ATIVAR BYPASS"
        bypassToggleBtn.BackgroundColor3 = colors.tertiary
        bypassStatus.Text = "Status: Inativo"
        bypassStatus.TextColor3 = colors.textDim
    end
end)

-- Atualiza√ß√µes autom√°ticas
task.spawn(function()
    while true do
        updateWorldInfo()
        if page2.Visible and inLeafWorld then
            updateStarsList()
        end
        task.wait(2)
    end
end)

task.spawn(function()
    while true do
        if page3.Visible then
            updateMobsList()
        end
        if page4.Visible then
            updateUnitsList()
        end
        task.wait(3)
    end
end)

-- Inicializa√ß√£o
updateWorldInfo()
updateStarsList()
updateMobsList()
updateUnitsList()
switchPage(1)

print("‚úÖ Stelk Hub v11.0 - Final Edition carregado!")
print("üìå Bot√£o toggle no canto | Movimento suave anti-kick")
